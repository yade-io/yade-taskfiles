# yaml-language-server: $schema=https://taskfile.dev/schema.json
version: 3

silent: true

tasks:
  create:venv:
    desc: "Create Python Virtual Environment"
    dir: "{{.WORKING_DIR}}"
    vars:
      WORKING_DIR: '{{default "." .WORKING_DIR}}'
      VENV_DIR: '{{default ".venv" .VENV_DIR}}'
      DEBUG: '{{default "false" .DEBUG}}'
      DRY_RUN: '{{default "false" .DRY_RUN}}'
      COMMAND: |
        python3 -m venv {{.VENV_DIR}}
    cmds:
      - |
        echo ""
        echo "ðŸš€ {{.TASK}} ($(pwd))"
        echo "     WORKING_DIR: {{.WORKING_DIR}}"
        echo "     VENV_DIR: {{.VENV_DIR}}"

        if [ "{{.DEBUG}}" == "true" ]; then
          echo "     COMMAND: {{.COMMAND}}"
        fi

        if [ "{{.DRY_RUN}}" == "true" ]; then
          echo "     Skipping command execution due to DRY_RUN."
        else
          {{.COMMAND}}
        fi

  install:requirements:
    desc: "Install python pip requirements"
    dir: "{{.WORKING_DIR}}"
    vars:
      WORKING_DIR: '{{default "." .WORKING_DIR}}'
      DEBUG: '{{default "false" .DEBUG}}'
      DRY_RUN: '{{default "false" .DRY_RUN}}'
      COMMAND: |
        pip install -r requirements.txt
    cmds:
      - |
        echo ""
        echo "ðŸš€ {{.TASK}} ($(pwd))"
        echo "     WORKING_DIR: {{.WORKING_DIR}}"
        # echo ""

        if [ "{{.DEBUG}}" == "true" ]; then
          echo "     COMMAND: {{.COMMAND}}"
        fi

        if [ "{{.DRY_RUN}}" == "true" ]; then
          echo "     Skipping command execution due to DRY_RUN."
        else
          {{.COMMAND}}
        fi
